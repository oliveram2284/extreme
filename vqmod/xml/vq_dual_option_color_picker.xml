<?xml version="1.0" encoding="UTF-8"?>

<modification>
    <id>Dual Option Color Picker</id>
    <version>1.0</version>
    <vqmver>2.X</vqmver>
    <author>Molivera</author>

    <file name="admin/language/es/catalog/option.php">
        <operation info="Add Option Color">
            <search position="after" offset="1" index='1'>
                <![CDATA[ $_['error_product']       = 'Advertencia: No se puede eliminar, actualmente esta asignado a %s productos.'; ]]>
            </search>
            <add>
                <![CDATA[
                    $_['text_color']         = 'Colores';
                    $_['entry_color_title']       = '<b> Nombre de Colores  </b>';
                    $_['entry_color1']       = '<b> Color 1 </b>';
                    $_['entry_color2']       = '<b> Color 2 </b>';
                    $_['entry_color_size']   = '<b> Tiene Todos los Talles? </b>';
                ]]>
            </add>
        </operation>
    </file>

    <file name="admin/controller/catalog/option.php">
        <operation info="Add Option Color">
            <search position="after" offset="1" index='1'>
                <![CDATA[ $this->load->model('catalog/option'); ]]>
            </search>
            <add>
                <![CDATA[ $this->model_catalog_option->update_table(); ]]>
            </add>
        </operation>
        <operation info="Add Option Color">
            <search position="after" offset="1" index='1'>
                <![CDATA[ $data['text_time'] = $this->language->get('text_time'); ]]>
            </search>
            <add>
                <![CDATA[ $data['text_color'] = $this->language->get('text_color'); ]]>
                <![CDATA[ $data['entry_color_title'] = $this->language->get('entry_color_title'); ]]>
                <![CDATA[ $data['entry_color1'] = $this->language->get('entry_color1'); ]]>
                <![CDATA[ $data['entry_color2'] = $this->language->get('entry_color2'); ]]>
                <![CDATA[ $data['entry_color_size'] = $this->language->get('entry_color_size'); ]]>
            </add>
        </operation>
        
    </file>
    
    <file name="admin/model/catalog/option.php">
        <operation info="Add Option Color">
            <search position="before" >
                <![CDATA[ public function addOption($data) { ]]>
            </search>
            <add>
                <![CDATA[ public function update_table(){
                    // Add Column if not exists
                    $query = $this->db->query("DESC `".DB_PREFIX."option_value` color1");
                    if (!$query->num_rows) {
                        $this->db->query("ALTER TABLE `" . DB_PREFIX . "option_value` ADD `color1` varchar(10) NULL AFTER `image`");
                    }
                    $query = $this->db->query("DESC `".DB_PREFIX."option_value` color2");
                    if (!$query->num_rows) {
                        $this->db->query("ALTER TABLE `" . DB_PREFIX . "option_value` ADD `color2` varchar(10) NULL AFTER `color1`");
                    }
                    $query = $this->db->query("DESC `".DB_PREFIX."option_value` all_size");
                    if (!$query->num_rows) {
                        $this->db->query("ALTER TABLE `" . DB_PREFIX . "option_value` ADD `all_size` int(1) NULL DEFAULT '0' AFTER `color2`");
                    }
                }]]>
            </add>
        </operation>
         
        <operation info="Add Option Color">
            <search position="replace" >
                <![CDATA[ $this->db->query("INSERT INTO " . DB_PREFIX . "option_value SET option_id = '" . (int)$option_id . "', image = '" . $this->db->escape(html_entity_decode($option_value['image'], ENT_QUOTES, 'UTF-8')) . "', sort_order = '" . (int)$option_value['sort_order'] . "'"); ]]>
            </search>
            <add>
                <![CDATA[
               
                $this->db->query("INSERT INTO " . DB_PREFIX . "option_value SET option_id = '" . (int)$option_id . "',image = '" . $this->db->escape(html_entity_decode($option_value['image'], ENT_QUOTES, 'UTF-8')) . "',color1 = '" . $this->db->escape($option_value['option_color_1']) . "',color2 = '" . $this->db->escape($option_value['option_color_2']) . "',all_size = '" .  (int)(isset($option_value['option_color_2']))?$option_value['option_color_2']:0 . "',sort_order = '" . (int)$option_value['sort_order'] . "'");
                ]]>
            </add>
        </operation>
       
  	

    </file>

    <!-- 
    
    -->
    <!-- 
    <file name="admin/view/template/catalog/option_form.tpl">
        <operation info="Add Option Color">
            <search position="after" offset="1" index='4'>
                <![CDATA[  </optgroup> ]]>
            </search>
            <add>            
            <![CDATA[
               <option value="color"><?php echo $text_color?> </option>
            ]]>
            </add>           
        </operation>

        <operation info="Add Option Color Table">
            <search position="after" offset="1" index='1'>
                <![CDATA[  </table> ]]>
                
            </search>
            <add>            
            <![CDATA[
              <h3>S</h3>
            ]]>
            </add>    
        </operation>
            
        <operation error="skip" info="Add Twig support">
            <search position="replace">
                <![CDATA[	} else {  ]]>
            </search>
            <add>
                <![CDATA[ } else if( this.value == 'color' ){ 
                                alert("hola");
                            }else {               
                    ]]>
            </add>
        </operation>
    </file>
    -->
</modification> 

